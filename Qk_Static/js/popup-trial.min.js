function showModalTrial(n,t,i){var a,r,s,l,u,f,e,o,h,c;popupOpen==!1&&(popupOpen=!0,a=urlApp,r=getParameterByName("location"),r!==null&&r!==""&&setCookie("location",r,30),s="",i&&(s="OMNI"),l=$(n).parent().parent().find(".input-site-name").val(),u=getParameterByName("sales_team"),u!==null&&u!==""&&setCookie("sales_team",u,30),f=getParameterByName("kd"),f!==null&&f!==""&&setCookie("kd",f,30),e=getParameterByName("ref"),e!==null&&e!==""&&setCookie("ref",e,30),o=getParameterByName("campaign"),o!==null&&o!==""&&setCookie("campaign",o,30),h=getCookie("start_time"),(h==null||h=="")&&setCookie("start_time",getDateTime(),.0115),c=window.location.href,setCookie("source",c,30),checkShowCaptcha(t,l,c,s))}function createModal(n,t,i,r,u){var v=$('<div id="trialPopupModal" class="modal fade modal-register modal-register-default" role="dialog"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span class="ti-close"><\/span><\/button><div class="modal-dialog" role="document"><div class="modal-content"><div class="roof-store"><img src="https://www.sapo.vn/Themes/Portal/Default/StylesV2/images/fnb/roof-store.png"><\/div><div class="modal-body"><\/div><\/div><\/div><\/div>'),w=v.find(".modal-body"),f,h,rt,ut,a;switch(n){case 1:h="<h2>Dùng thử Sapo miễn phí 15 ngày<\/h2><p>+67,000 doanh nghiệp & chủ shop tin dùng<\/p>";break;case 2:h="<h2>Dùng thử website bán hàng Sapo Web<\/h2><p>Miễn phí 15 ngày với đầy đủ tính năng<\/p>";break;case 3:h="<h2>Dùng thử phần mềm quản lý fanpage Sapo Social<\/h2><p>Được tích hợp miễn phí trên Sapo<\/p>";break;case 4:h="<h2>Dùng thử phần mềm quản lý bán hàng Sapo POS<\/h2><p>Miễn phí 15 ngày với đầy đủ tính năng<\/p>";break;case 5:h="<h2>Dùng thử Sapo Omnichannel miễn phí 15 ngày<\/h2><p>+67,000 doanh nghiệp & chủ shop tin dùng<\/p>";break;case 6:h="<h2>Dùng thử Sapo GO miễn phí 15 ngày<\/h2><p>+67,000 doanh nghiệp & chủ shop tin dùng<\/p>";break;case 7:h="<h2>Dùng thử Sapo miễn phí 15 ngày<\/h2><p>+67,000 doanh nghiệp & chủ shop tin dùng<\/p>";break;default:h="<h2>Dùng thử Sapo miễn phí 15 ngày<\/h2><p>+67,000 doanh nghiệp & chủ shop tin dùng<\/p>"}jQuery.ui?(f=$("<form/>",{action:urlApp,id:"trialForm","class":"form-request",onsubmit:"return handleSubmit(event, "+n+")",method:"POST","accept-charset":"UTF-8"}),f.autocomplete()):f=$("<form/>",{action:urlApp,id:"trialForm",autocomplete:"off","class":"form-request",onsubmit:"return handleSubmit(event, "+n+")",method:"POST","accept-charset":"UTF-8"});var y=$("<div/>",{"class":"row"}),l=$("<div/>",{"class":"col-md-6"}),e=$("<div/>",{"class":"form-group mdc-text-field"}),o=$("<label/>",{"for":""}),ft=$("<ul/>",{"class":"register-form-error"}),p=$("<input/>",{type:"text",pattern:"^.{3,60}$",maxlength:"60",id:"StoreName","class":"form-control form-input",name:"StoreName",required:"",title:"Tên của hàng dài từ 3 đến 60 ký tự"});t!=undefined&&t!=""&&p.val(t).addClass("valid");var b=$("<input/>",{type:"text",maxlength:"60",id:"FullName","class":"form-control form-input",name:"FullName",required:""}),k=$("<input/>",{type:"text",pattern:"^\\d{8,11}$",maxlength:"15",id:"PhoneNumber","class":"form-control form-input",name:"PhoneNumber",required:""}),d=$("<input/>",{type:"email",pattern:"^([a-zA-Z0-9_\\-\\.\\+]+)@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.)|(([a-zA-Z0-9\\-]+\\.)+))([a-zA-Z]{2,4}|[0-9]{1,3})(\\]?)$",maxlength:"50",id:"Email","class":"form-control form-input",name:"Email",required:""}),g=$("<input/>",{type:"password",pattern:"^.{6,64}$",maxlength:"64",id:"Password","class":"form-control form-input",name:"Password",required:""}),s=$("<select/>",{id:"PackageType",name:"PackageType",required:""}),nt='<option value="" hidden><\/option><option value="pos">Phần mềm quản lý bán hàng<\/option><option value="web">Thiết kế website bán hàng<\/option><option value="sapo_go">Quản lý bán hàng online (Facebook & Sàn TMĐT)<\/option><option value="omni">Quản lý và bán hàng đa kênh<\/option>"',tt='<option value="" hidden><\/option><option value="sapo_go">Quản lý bán hàng online (Facebook & Sàn TMĐT)<\/option><option value="omni">Quản lý và bán hàng đa kênh<\/option>"',c='<input autocomplete="off" type="text" value="" name="CaptchaInput" id="CaptchaInput" maxlength="4" required class="form-control form-input"><a onclick="resetCaptcha(this)" class="resetCaptchaBtn" id="captchaReset" href="javascript:void(0);"><\/a><div id="Captcha"><\/div>',et=$("<button/>",{type:"submit","class":"btn-registration"}).html('<span>Đăng ký dùng thử<\/span><i class="fa fa-spinner fa-spin"><\/i>'),it=$("<div/>",{"class":"social-login"}).html("<span>Hoặc đăng ký nhanh bằng tài khoản<\/span>"),ot='<a href="javascript:void(0)" onclick="registerFacebook('+n+')"><img src="https://www.sapo.vn/Themes/Portal/Default/StylesV2/images/svg_sociallogin_fb_new.svg" alt="Sapo" /><\/a><a href="javascript:void(0)" onclick="registerGoogle('+n+')"><img src="https://www.sapo.vn/Themes/Portal/Default/StylesV2/images/svg_sociallogin_gg_new.svg" alt="Sapo" /><\/a>';it.append($("<div/>",{"class":"social-login__btn-group"}).html(ot));rt='<input id="Preferred" name="Preferred" type="hidden" value="'+(getCookie("preferred")!=null?getCookie("preferred"):"")+'"><input id="SaleName" name="SaleName" type="hidden" value="'+(getCookie("kd")!=null?getCookie("kd"):"")+'"><input id="Reference" name="Reference" type="hidden" value="'+(getCookie("ref")!=null?getCookie("ref"):"")+'"><input id="Source" name="Source" type="hidden" value="'+(i!=null?i:"")+'"><input id="Referral" name="Referral" type="hidden" value="'+(getCookie("referral")!=null?getCookie("referral"):"")+'"><input id="Campaign" name="Campaign" type="hidden" value="'+(getCookie("campaign")!=null?getCookie("campaign"):"")+'"><input id="LandingPage" name="LandingPage" type="hidden" value="'+(getCookie("landing_page")!=null?getCookie("landing_page"):"")+'"><input id="StartTime" name="StartTime" type="hidden" value="'+(getCookie("start_time")!=null?getCookie("start_time"):"")+'"><input id="EndTime" name="EndTime" type="hidden" value="'+(getDateTime()!=null?getDateTime():"")+'"><input id="PageView" name="PageView" type="hidden" value="'+(getCookie("pageview")!=null?getCookie("pageview"):"")+'"><input id="AffId" name="AffId" type="hidden" value="'+(getCookie("aff_id")!=null?getCookie("aff_id"):"")+'"><input id="AffTrackingId" name="AffTrackingId" type="hidden" value="'+(getCookie("aff_id")!=null?getCookie("aff_tracking_id"):"")+'"><input id="Type" name="Type" type="hidden" value="'+n+'"><input id="PreferredService" name="PreferredService" type="hidden" value="'+(r!=null?r:"")+'"><input id="SalesTeam" name="SalesTeam" type="hidden" value="'+(getCookie("sales_team")!=null?getCookie("sales_team"):"")+'"><input id="SocialSource" name="SocialSource" type="hidden" value=""><input id="FacebookName" name="FacebookName" type="hidden" value=""><input id="FacebookAvatar" name="FacebookAvatar" type="hidden" value="">';f.append(ft);p=e.clone().append(p).append(o.clone().attr("for","StoreName").text("Tên cửa hàng của bạn"));b=e.clone().append(b).append(o.clone().attr("for","FullName").text("Họ tên của bạn"));k=e.clone().append(k).append(o.clone().attr("for","PhoneNumber").text("Số điện thoại của bạn"));d=e.clone().append(d).append(o.clone().attr("for","Email").text("Email đăng ký"));g=e.clone().append(g).append(o.clone().attr("for","Password").text("Mật khẩu đăng nhập cửa hàng của bạn"));ut=y.clone().append(l.clone().append(b)).append(l.clone().append(k));f.append(p).append(ut).append(d).append(g);n!=2&&n!=3&&n!=4&&n!=5&&n!=6&&n!=7?u!="VN"?(s=e.clone().addClass("mdc-select-field").append(s.html(nt)).append(o.clone().attr("for","PackageType").text("Chọn sản phẩm bạn quan tâm")),c=e.clone().addClass("mdc-text-field captcha-field").append(c).append(o.clone().attr("for","CaptchaInput").text("Mã an toàn")),a=y.clone().append(l.clone().append(s)).append(l.clone().append(c)),f.append(a),createCaptcha(f)):(s=e.clone().addClass("mdc-select-field").append(s.html(nt)).append(o.clone().attr("for","PackageType").text("Chọn sản phẩm bạn quan tâm")),f.append(s)):n==7?u!="VN"?(s=e.clone().addClass("mdc-select-field").append(s.html(tt)).append(o.clone().attr("for","PackageType").text("Chọn sản phẩm bạn quan tâm")),c=e.clone().addClass("mdc-text-field captcha-field").append(c).append(o.clone().attr("for","CaptchaInput").text("Mã an toàn")),a=y.clone().append(l.clone().append(s)).append(l.clone().append(c)),f.append(a),createCaptcha(f)):(s=e.clone().addClass("mdc-select-field").append(s.html(tt)).append(o.clone().attr("for","PackageType").text("Chọn sản phẩm bạn quan tâm")),f.append(s)):u!="VN"&&(c=e.clone().addClass("mdc-text-field captcha-field").append(c).append(o.clone().attr("for","CaptchaInput").text("Mã an toàn")),a=y.clone().append(l.clone().append(c)),f.append(a),createCaptcha(f));f.append(e.clone().append(et)).append(it).append(rt);w.html("");w.append(h);w.append(f);$("#trialPopupModal").remove();v.modal({backdrop:"static",keyboard:!1});v.modal("show");v.on("hidden.bs.modal",function(){popupOpen=!1});v.find('input[type="text"], input[type="email"], input[type="password"]').on("keyup",function(){var n=$(this);n.val()==""?n.removeClass("valid"):n.addClass("valid")})}function handleSubmit(n,t){var i=$("form#trialForm"),r,u;return(i.find(".register-form-error").empty(),i.find(".btn-registration").addClass("btn-loading"),r="",u=i.find("#StoreName").val(),i.find("#CaptchaInput").val()!=codeCaptcha&&showCaptcha==!0)?(i.find("#CaptchaInput").val("").removeClass("valid"),i.find(".register-form-error").html("<li>Sai mã an toàn<\/li>"),$(".resetCaptchaBtn").trigger("click"),i.find("#CaptchaInput").focus(),i.find(".btn-registration").removeClass("btn-loading"),!1):(checkAliasVer2(u,function(f){if(f)n.preventDefault(),$.ajax({url:urlApp,type:"post",data:i.serialize(),success:function(n){setTimeout(function(){window.location.href=n.result.redirectUrl},400)},error:function(n){if(i.find(".btn-registration").removeClass("btn-loading"),n.responseJSON&&n.responseJSON.error.includes("capcha")!==-1)alert("Số lần đăng ký của bạn đã vượt quá giới hạn. Bạn hãy nhập mã an toàn để tiếp tục đăng ký dùng thử."),buildRedirectUrlCaptcha(t,i);else{if(n.responseJSON&&n.responseJSON.error)for(var e=n.responseJSON.error.replace(/\n/g,"; ").replace(/; $/,""),f=e.split(";"),u=0;u<f.length;++u)r+="<li>"+f[u]+"<\/li>";else r+="<li>Có lỗi xảy ra<\/li>";if(!!r)return i.find(".register-form-error").html(r),i.find(".register-form-error").addClass("show"),!1}}});else return i.find(".register-form-error").html("<li>Cửa hàng <strong>"+u+"<\/strong> đã tồn tại trong hệ thống!<\/li>"),i.find(".register-form-error").addClass("show"),i.find(".btn-registration").removeClass("btn-loading"),!1}),!1)}function encodeURIParams(n,t){var r=[],i,u;for(i in n)n.hasOwnProperty(i)&&(u=n[i],u!=null&&r.push(encodeURIComponent(i)+"="+encodeURIComponent(u)));return r.length==0?"":(t?"?":"")+r.join("&")}function bodauTiengViet(n){return n=n.toLowerCase(),n=n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),n=n.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),n=n.replace(/ì|í|ị|ỉ|ĩ/g,"i"),n=n.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),n=n.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),n=n.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),n.replace(/đ/g,"d")}function getParameterByName(n){n=n.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var i=new RegExp("[\\?&]"+n+"=([^&#]*)"),t=i.exec(location.search);return t===null?"":decodeURIComponent(t[1].replace(/\+/g," "))}function onInputStoreName(n){if(n.keyCode==13)return!1}function generateAlias(n){return n=n.toLowerCase(),n=n.replace(/à|á|ạ|ả|ã|â|ầ|ấ|ậ|ẩ|ẫ|ă|ằ|ắ|ặ|ẳ|ẵ/g,"a"),n=n.replace(/è|é|ẹ|ẻ|ẽ|ê|ề|ế|ệ|ể|ễ/g,"e"),n=n.replace(/ì|í|ị|ỉ|ĩ/g,"i"),n=n.replace(/ò|ó|ọ|ỏ|õ|ô|ồ|ố|ộ|ổ|ỗ|ơ|ờ|ớ|ợ|ở|ỡ/g,"o"),n=n.replace(/ù|ú|ụ|ủ|ũ|ư|ừ|ứ|ự|ử|ữ/g,"u"),n=n.replace(/ỳ|ý|ỵ|ỷ|ỹ/g,"y"),n=n.replace(/đ/g,"d"),n=n.replace(/'|\"|\(|\)|\[|\]/g,""),n=n.replace(/\W+/g,"-"),n.slice(-1)==="-"&&(n=n.replace(/-+$/,"")),n.slice(0,1)==="-"&&(n=n.replace(/^-+/,"")),n}function setCookie(n,t,i){var r,u;i||(i=30);r=new Date;r.setTime(r.getTime()+i*864e5);u="expires="+r.toGMTString();document.cookie=n+"="+t+"; "+u+";domain=.sapo.vn;path=/"}function newSetCookie(n,t){document.cookie=n+"="+t}function getUrlWithoutDomain(n){return n.replace(/^.*\/\/[^\/]+/,"")}function getCookie(n){for(var t,r=n+"=",u=document.cookie.split(";"),i=0;i<u.length;i++){for(t=u[i];t.charAt(0)==" ";)t=t.substring(1);if(t.indexOf(r)==0)return t.substring(r.length,t.length)}return null}function getSessionStorage(n){return window.sessionStorage.getItem(n)}function setSessionStorage(n,t){window.sessionStorage.setItem(n,t)}function guid(){return"xxxxxxxx-xxxx-4xxx-yxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)}).toUpperCase()}function setParameter(n,t,i){if(n.indexOf(t+"=")>=0){var u=n.substring(0,n.indexOf(t)),r=n.substring(n.indexOf(t));r=r.substring(r.indexOf("=")+1);r=r.indexOf("&")>=0?r.substring(r.indexOf("&")):"";n=u+t+"="+i+r}else n+=n.indexOf("?")<0?"?"+t+"="+i:"&"+t+"="+i;return n}function getDateTime(){var n=new Date,t=n.getDate(),i=n.getMonth()+1,r=n.getFullYear(),u=n.getHours(),f=n.getMinutes(),e=n.getSeconds(),datetime;return t<10&&(t="0"+t),i<10&&(i="0"+i),i+"/"+t+"/"+r+" "+u+":"+f+":"+e}function checkAliasVer2(n,t){checkAliasWeb(n,function(i){i?t(!1):checkAliasPOS(n,function(n){n?t(!1):t(!0)})})}function checkAliasWeb(n,t){$.ajax({url:"https://store.mysapo.net/admin/createstore/CheckAliasAvailable",type:"post",data:{StoreName:n},success:function(){t(!0)},error:function(){t(!1)}})}function checkAliasPOS(n,t){$.ajax({url:"https://mytenant.mysapo.vn/admin/register/CheckAvaiableStoreByDomain",type:"post",data:{domain:n},success:function(){t(!0)},error:function(){t(!1)}})}function buildRedirectUrlCaptcha(n,t){var i=urlApp+"?Type="+n;$(t).find("input").each(function(){var n=$(this);n.val()!=""&&n.val()!=null&&n.attr("name")!="Type"&&n.attr("name")!="Password"&&(i+="&"+n.attr("name")+"="+n.val())});$(t).find("select").length>0&&(i+="&"+$(t).find("select").attr("name")+"="+$(t).find("select").val());window.location.href=i}function buildRedirectUrl(n,t){if(!redirectUri||redirectUri===""||redirectUri.toString().toLowerCase()==="iphone"||redirectUri.toString().toLowerCase()==="android")return urlApp;var r=new URL(redirectUri),u=r.search,i=new URLSearchParams(u);return i.set("type",n),i.set("show_popup","true"),getCookie("source")!=null&&getCookie("source")!=""&&i.set("source",getCookie("source")),getCookie("kd")!=null&&getCookie("kd")!=""&&i.set("SaleName",getCookie("kd")),getCookie("aff_id")!=null&&getCookie("aff_id")!=""&&i.set("AffId",getCookie("aff_id")),getCookie("aff_tracking_id")!=null&&getCookie("aff_tracking_id")!=""&&i.set("AffTrackingId",getCookie("aff_tracking_id")),i.set("sourceInfo",t),r.search=i.toString(),r.toString()}function registerFacebook(n){var t={client_id:"139581822752227",redirect_uri:"https://app.sapo.vn/oauth/FacebookOauthCallback",state:JSON.stringify({redirectUrl:buildRedirectUrl(n,"facebook"),type:"signup"}),scope:"email",response_type:"code"},i="https://www.facebook.com/v3.2/dialog/oauth"+encodeURIParams(t,!0);window.location.href=i}function registerGoogle(n){var t={client_id:"155464390759-8gd2imthgssr03ar2ocb27n6uk3e1j71.apps.googleusercontent.com",redirect_uri:"https://app.sapo.vn/oauth/GoogleOauthCallback",scope:"email profile https://www.googleapis.com/auth/userinfo.email https://www.googleapis.com/auth/userinfo.profile",access_type:"online",state:JSON.stringify({redirectUrl:buildRedirectUrl(n,"google"),type:"signup"}),response_type:"code"},i="https://accounts.google.com/o/oauth2/v2/auth"+encodeURIParams(t,!0);window.location.href=i}function checkShowCaptcha(n,t,i,r){$.ajax({url:"https://www.sapo.vn/CheckIPLocationTrial",method:"POST",success:function(u){showCaptcha=u.CountryCode!="VN"?!0:!1;createModal(n,t,i,r,u.CountryCode)},error:function(){},complete:function(){}})}function createCaptcha(n){var u,e,t,i;n.find("#CaptchaInput").val("");n.find("#Captcha").html("");var f="0123456789abcdefghijklmnopqrstuvwxyz",r=[];for(u=0;u<4;u++)e=Math.floor(Math.random()*f.length),r.push(f[e]);t=document.createElement("canvas");t.id="CaptchaCanv";t.width=95;t.height=42;i=t.getContext("2d");i.font="bold 25px Arial";i.textAlign="center";i.fillStyle="#333333";i.fillText(r.join(""),45,30);codeCaptcha=r.join("");n.find("#Captcha").append(t)}function resetCaptcha(n){var u,e,t,i;$(n).parent().find("#CaptchaInput").val("");$(n).parent().find("#Captcha").html("");var f="0123456789abcdefghijklmnopqrstuvwxyz",r=[];for(u=0;u<4;u++)e=Math.floor(Math.random()*f.length),r.push(f[e]);t=document.createElement("canvas");t.id="CaptchaCanv";t.width=95;t.height=42;i=t.getContext("2d");i.font="bold 25px Arial";i.textAlign="center";i.fillStyle="#333333";i.fillText(r.join(""),45,30);codeCaptcha=r.join("");$(n).parent().find("#Captcha").append(t)}var urlApp="https://app.sapo.vn/services/signup",codeCaptcha,showCaptcha=!1,popupOpen=!1,redirectUri;$(document).ready(function(){var s=getCookie("aff_id"),t=getParameterByName("aff_id"),n=getParameterByName("aff_tracking_id"),i,r,u,f,e,h,c,o;s==null||s==""?(t!==null&&t!==""&&setCookie("aff_id",t,30),n!==null&&n!==""&&setCookie("aff_tracking_id",n,30)):t==s&&n!==null&&n!==""&&setCookie("aff_tracking_id",n,30);i=getParameterByName("kd");i!==null&&i!==""&&setCookie("kd",i,30);r=getParameterByName("sales_team");r!==null&&r!==""&&setCookie("sales_team",r,30);u=getParameterByName("ref");u!==null&&u!==""&&setCookie("ref",u,30);f=getParameterByName("campaign");f!==null&&f!==""&&setCookie("campaign",f,30);document.referrer&&document.referrer!=""&&document.referrer.indexOf("www.sapo.vn")==-1&&setCookie("referral",document.referrer,30);e=getParameterByName("aff_partner_id");e!==null&&e!==""&&setCookie("partner",e,30);h=getCookie("landing_page");(h==null||h=="")&&setCookie("landing_page",document.location.href,.0115);c=getCookie("start_time");(c==null||c=="")&&setCookie("start_time",getDateTime(),.0115);o=getCookie("pageview");o==null||o==""?setCookie("pageview",1,.0115):setCookie("pageview",parseInt(o)+1,.0115)});redirectUri=urlApp;